<?xml version='1.0' ?>
<!-- 
/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
   Copyright (c) 2012 - 2013 MAXHyperMarket, Inc.    All Rights Reserved.
      	Rev 1.1  18/Jul/2013	Jyoti Rawal, Bug 7195 - GC- POS Crashed while reloading with 5500
  	Rev 1.0  15/Apr/2013	Jyoti Rawal, Initial Draft: Changes for Gift Card Functionality 
 * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
 -->
<!DOCTYPE SERVICE SYSTEM "classpath://oracle/retail/stores/foundation/tour/dtd/tourguide.dtd">

<SERVICE
    name="GiftCardReload"
    package="oracle.retail.stores.pos.services.giftcard.reload"
    tourcam="ON">
    <COMMENT>
        Point-Of-Sale is the implementation of the Sale
        Package Requirements.
    </COMMENT>
    <CARGO class="MAXGiftCardCargo" package="max.retail.stores.pos.services.giftcard"/>
    <SERVICECODE>
        <LETTER name="Cancel"/>
        <LETTER name="Undo"/>
        <LETTER name="Offline"/>
        <LETTER name="Continue"/>
        <LETTER name="Next"/>
        <LETTER name="Ok"/>
        <LETTER name="First"/>
        <LETTER name="Second"/>
        <LETTER name="Third"/>
        <LETTER name="Fourth"/>
        <LETTER name="Fifth"/>
        <LETTER name="Sixth"/>
        <LETTER name="Seventh"/>
        <LETTER name="Overrideden"/>
      <LETTER name="RequestActivation"/>
      <LETTER name="InvalidCardNumber"/><!-- Rev 1.0 -->
       <SHUTTLE class="SecurityOverrideLaunchShuttle"
			package="oracle.retail.stores.pos.services.admin.security.common" />
        <LANEACTION class="GiftCardReloadAmountEnteredAisle"/>
        <LANEACTION class="GiftCardReloadCardNumEnteredAisle"/>
         <SITEACTION class="GetAmountForGiftCardReloadSite"/>
        <SITEACTION class="GetCardNumForGiftCardReloadSite"/>
        <!-- Rev 1.0 : Starts -->
		<LANEACTION class="MAXGiftCardReloadAmountEnteredAisle" package="max.retail.stores.pos.services.giftcard.reload"/>
		<LANEACTION class="MAXGiftCardReloadCardNumEnteredAisle" package="max.retail.stores.pos.services.giftcard.reload"/>
        <SITEACTION class="MAXGetAmountForGiftCardReloadSite" package="max.retail.stores.pos.services.giftcard.reload"/>
        <SITEACTION class="MAXGetCardNumForGiftCardReloadSite" package="max.retail.stores.pos.services.giftcard.reload"/>
        <LANEACTION class="MAXCheckAccessForGCAmountAisle" package="max.retail.stores.pos.services.giftcard.reload"/>
	<!-- Rev 1.0 ends-->
	<!--Rev 1.1 starts-->
         <SITEACTION  class="CheckAccessSite" package="oracle.retail.stores.pos.services.admin.security.common"/>
        <!-- Rev 1.1 :Ends -->
        </SERVICECODE>
    <MAP>
        <REGION region="SERVICE" startsite="GetAmountForGiftCardReload">
        <!-- Rev 1.0 changes start -->
            <SITE name="GetAmountForGiftCardReload" siteaction="MAXGetAmountForGiftCardReloadSite">
                <AISLE
                    name="AmountEntered1"
                    letter="Next"
                    laneaction="MAXCheckAccessForGCAmountAisle">
                </AISLE>
                <AISLE
                    name="AmountEntered"
                    letter="Overrideden"
                    laneaction="MAXGiftCardReloadAmountEnteredAisle">
                </AISLE>
                <AISLE
                    name="FirstSelected"
                    letter="First"
                    laneaction="MAXGiftCardReloadAmountEnteredAisle">
                </AISLE>
                <AISLE
                    name="SecondSelected"
                    letter="Second"
                    laneaction="MAXGiftCardReloadAmountEnteredAisle">
                </AISLE>
                <AISLE
                    name="ThirdSelected"
                    letter="Third"
                    laneaction="MAXGiftCardReloadAmountEnteredAisle">
                </AISLE>
                <AISLE
                    name="FourthSelected"
                    letter="Fourth"
                    laneaction="MAXGiftCardReloadAmountEnteredAisle">
                </AISLE>
                <AISLE
                    name="FifthSelected"
                    letter="Fifth"
                    laneaction="MAXGiftCardReloadAmountEnteredAisle">
                </AISLE>
                <AISLE
                    name="SixthSelected"
                    letter="Sixth"
                    laneaction="MAXGiftCardReloadAmountEnteredAisle">
                </AISLE>
                <AISLE
                    name="SeventhSelected"
                    letter="Seventh"
                    laneaction="MAXGiftCardReloadAmountEnteredAisle">
                </AISLE>
                <!-- Rev 1.0 changes end -->
                <ROAD name="OverrideRequired" 
	                letter="Override" 
	                destination="CheckSecurityAccess"
					tape="ADVANCE" record="OFF" index="OFF">
				</ROAD>
                <ROAD
                    name="AmountValidated"
                    letter="Continue"
                    destination="GetCardNumForGiftCardReload"
                    tape="ADVANCE" record="OFF" index="OFF">
                </ROAD>
                <ROAD
                    name="InvalidAmountEntered"
                    letter="Ok"
                    destination="GetAmountForGiftCardReload"
                    tape="ADVANCE" record="OFF" index="OFF">
                </ROAD>
                <ROAD
                    name="UndoSelected"
                    letter="Undo"
                    destination="Final"
                    tape="ADVANCE" record="OFF" index="OFF">
                </ROAD>
                <ROAD
                    name="CancelSelected"
                    letter="Cancel"
                    destination="Final"
                    tape="ADVANCE" record="OFF" index="OFF">
                </ROAD>
            </SITE>
	    <!--Rev 1.1 changes-->
            <SITE  name="CheckSecurityAccess" siteaction="CheckAccessSite">
            
            
                <ROAD 
                    name="NoAccess"
                    letter="Override"
                    destination="SecurityOverrideStation"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                </ROAD>
                <ROAD 
                    name="AccessGranted"
                    letter="Continue"
                    destination="GetCardNumForGiftCardReload"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                </ROAD>
            </SITE>
            <STATION name="SecurityOverrideStation" servicename="security.override.override"
				targettier="CURRENTTIER" launchshuttle="SecurityOverrideLaunchShuttle">
				<ROAD name="CancelTransactionSecurityOverrideSucceeded" letter="Success"
					destination="GetCardNumForGiftCardReload" tape="ADVANCE" record="OFF"
					index="OFF">
				</ROAD>
				<ROAD name="CancelTransactionSecurityOverrideFailed" letter="Failure"
					destination="GetAmountForGiftCardReload" tape="SPLICE" record="OFF" index="OFF">
				</ROAD>
			</STATION>
            <!-- SITE name="CheckAccessForGCAmount" siteaction="CheckAccessForGCAmountSite">
				<ROAD name="OverrideRequired" letter="Override" destination="SecurityOverrideStation"
					tape="ADVANCE" record="OFF" index="OFF">
				</ROAD>
				<ROAD name="CancelTransactionAccessGranted" letter="Continue"
					destination="PrintCancelTransaction" tape="ADVANCE" record="OFF"
					index="OFF">
				</ROAD>
			</SITE -->
			<!-- Rev 1.0 changes start -->
            <SITE name="GetCardNumForGiftCardReload" siteaction="MAXGetCardNumForGiftCardReloadSite">
                <COMMENT>
                    This site displays the GET_CARD_NUM_FOR_GIFT_CARD_RELOAD from GiftCardNumReload to ask
                    the user to enter gift card number
                    item.
                </COMMENT>
                <AISLE
                    name="GiftCardNumberEntered"
                    letter="Next"
                    laneaction="MAXGiftCardReloadCardNumEnteredAisle">
                    <COMMENT>
                        This aisle is traversed after the user entered the
                        gift card information. It adds the gift card to the
                        item list in the cargo.
                    </COMMENT>
                </AISLE>
                <!-- Rev 1.0 changes end -->
                <ROAD
                    name="GiftCardItemAdded"
                    letter="Continue"
                    destination="Final"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                </ROAD>
                <ROAD
                    name="ActivationRequested"
                    letter="RequestActivation"
                    destination="Final"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                </ROAD>
                <ROAD
                    name="InvalidGiftCardNumber"
                    letter="InvalidCardNumber"
                    destination="GetCardNumForGiftCardReload"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                    <COMMENT>
                        The gift card MAG swipe was invalid or the user
                        entered an invalid number. Allow user to
                        re-swipe or re-enter the gift card number.
                    </COMMENT>
                </ROAD>
                <ROAD
                    name="UndoSelected"
                    letter="Undo"
                    destination="GetAmountForGiftCardReload"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                </ROAD>
                <ROAD
                    name="CancelSelected"
                    letter="Cancel"
                    destination="Final"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                </ROAD>
            </SITE>
            <SYSTEMSITE name="Final" action="RETURN"/>
            <SYSTEMSITE name="LastIndexed" action="BACKUP"/>
        </REGION>
    </MAP>
</SERVICE>
