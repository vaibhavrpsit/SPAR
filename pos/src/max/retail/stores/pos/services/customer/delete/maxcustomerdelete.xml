<?xml version='1.0' ?>
<!--
/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
  Copyright (c) 2012 - 2013 MAX, Inc.    All Rights Reserved.
  Rev 1.1   Feb 16,2016     Nitika Arora     Changes for handling Cancel Menu letter.
  Rev 1.0   Izhar Ahmad  3/4/2013		Customer Changes
* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * */
-->
<!DOCTYPE SERVICE SYSTEM "classpath://oracle/retail/stores/foundation/tour/dtd/tourguide.dtd">

<SERVICE 
    name="CustomerDelete"
    package="oracle.retail.stores.pos.services.customer.delete"
    tourcam="ON">
    <COMMENT >
        Look up a customer in the database that matches the 
        criteria entered by the user.
    </COMMENT>
    <CARGO  class="MAXCustomerCargo" package="max.retail.stores.pos.services.customer.common"/>
    <SERVICECODE >
        <LANEACTION  class="ConfirmCustomerDeleteAisle"/>
        <LANEACTION  class="CustomerDeleteRoad"/>
        <LANEACTION  class="DeleteCustomerRoad"/>
        <LETTER  name="Cancel"/>
        <LETTER  name="CheckAccess"/>
        <LETTER  name="Continue"/>
        <LETTER  name="Delete"/>
        <LETTER  name="Failure"/>
        <LETTER  name="Override"/>
        <LETTER  name="Offline"/>
        <LETTER  name="Retry"/>
        <LETTER  name="Success"/>
        <LETTER  name="Undo"/>
        <LETTER name="RegCustomer"/>
        <LETTER name="BusCustomer"/>

        <SHUTTLE  class="CustomerLookupLaunchShuttle"/>
        <SHUTTLE  class="CustomerLookupReturnShuttle"/>
        <SHUTTLE  class="SecurityOverrideLaunchShuttle" package="oracle.retail.stores.pos.services.admin.security.common"/>
        <SIGNAL  class="IsOfflineSignal" package="oracle.retail.stores.pos.services.customer.common"/>
        <SIGNAL  class="IsOnlineSignal" package="oracle.retail.stores.pos.services.customer.common"/>
        <SITEACTION  class="CheckAccessSite" package="oracle.retail.stores.pos.services.admin.security.common"/>
          <!-- MAX Rev 1.0 Change : start -->
        <SITEACTION  class="MAXDeleteCustomerInfoSite" package="max.retail.stores.pos.services.customer.delete"/>
          <!-- MAX Rev 1.0 Change : end -->
       <SITEACTION class="MAXDeleteBusinessInfoSite" package="max.retail.stores.pos.services.customer.delete"/>
       <SITEACTION class="CheckCustomerTypeSite" package="oracle.retail.stores.pos.services.customer.common"/>
    </SERVICECODE>
    <MAP >
        <REGION  region="SERVICE" startsite="CheckSecurityAccess">
            <SITE  name="CheckSecurityAccess" siteaction="CheckAccessSite">
                <ROAD 
                    name="NoAccess"
                    letter="Override"
                    destination="SecurityOverrideStation"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                </ROAD>
                <ROAD 
                    name="DeleteAuthorized"
                    letter="Continue"
                    destination="CustomerLookupStation"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                </ROAD>
            </SITE>
            <STATION 
                name="SecurityOverrideStation"
                servicename="security.override.override"
                targettier="CURRENTTIER"
                launchshuttle="SecurityOverrideLaunchShuttle">
                <ROAD 
                    name="DeleteSecurityOverride"
                    letter="Success"
                    destination="CustomerLookupStation"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                </ROAD>
                <ROAD 
                    name="SecurityOverrideFailed"
                    letter="Failure"
                    destination="Final"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                </ROAD>
                <ROAD 
                    name="SecurityOverrideCancelled"
                    letter="Cancel"
                    destination="Final"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                </ROAD>
            </STATION>
            <STATION 
                name="CustomerLookupStation"
                servicename="customer.lookup.customerlookup"
                targettier="CURRENTTIER"
                launchshuttle="CustomerLookupLaunchShuttle"
                returnshuttle="CustomerLookupReturnShuttle">
                <ROAD 
                    name="CustomerLookupStationContinue"
                    letter="Continue"
                    destination="CheckCustomerType"
                    tape="ADVANCE"
                    record="OFF"
                    index="ON">
                </ROAD>
                <ROAD 
                    name="CustomerLookupStationOffline"
                    letter="Offline"
                    destination="Final"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                 </ROAD>
                <ROAD 
                    name="CustomerLookupStationUndo"
                    letter="Undo"
                    destination="Final"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                </ROAD>
                <ROAD 
                    name="CustomerLookupStationCancel"
                    letter="Cancel"
                    destination="Final"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                </ROAD>
                <ROAD 
                    name="CustomerLookupStationRetry"
                    letter="Retry"
                    destination="LastIndexed"
                    tape="REWIND"
                    record="OFF"
                    index="OFF">
                </ROAD>
                <ROAD
                    name="CustomerLookupCancelMenu"
                    letter="CancelMenu"
                    destination="Final"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                    <COMMENT>
                        The CustomerLookupCancelMenu road is traversed when
                        a CancelMenu letter is received from the UI.
                    </COMMENT>
                </ROAD>
            </STATION>
              <!-- MAX Rev 1.0 Change : start -->
            <SITE  name="DeleteCustomerInfo" siteaction="MAXDeleteCustomerInfoSite">
                <COMMENT >
                    Site that displays customer header information. 
                </COMMENT>
                <AISLE 
                    name="ConfirmCustomerDelete"
                    letter="Delete"
                    laneaction="ConfirmCustomerDeleteAisle">
                </AISLE>
                <ROAD 
                    name="DeleteCustomerContinue"
                    letter="Continue"
                    laneaction="DeleteCustomerRoad"
                    destination="Final"
                    tape="ADVANCE"
                    record="OFF"
                    index="ON">
                </ROAD>
                <ROAD 
                    name="DeleteCustomerUndo"
                    letter="Undo"
                    destination="CustomerLookupStation"
                    tape="REWIND"
                    record="OFF"
                    index="OFF">
                </ROAD>
                <ROAD 
                    name="DeleteCustomerRetry"
                    letter="Retry"
                    destination="DeleteCustomerInfo"
                    tape="REWIND"
                    record="OFF"
                    index="OFF">
                </ROAD>
                <ROAD 
                    name="DeleteCustomerCancel"
                    letter="Cancel"
                    destination="Final"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                </ROAD>
            </SITE>

          <SITE name="DeleteBusinessInfo" siteaction="MAXDeleteBusinessInfoSite">
               <COMMENT>
                    Site that displays business customer header information.
               </COMMENT>
               <AISLE name="ConfirmBusinessDelete"
                     letter="Delete"
                     laneaction= "ConfirmCustomerDeleteAisle">
               </AISLE>
               <ROAD name="DeleteBusinessContinue"
                     letter="Continue"
                     laneaction="DeleteCustomerRoad"
                     destination="Final"
                     tape="ADVANCE" record="OFF" index="ON">
               </ROAD>
               <ROAD name="DeleteBusinessUndo"
                     letter="Undo"
                     destination="CustomerLookupStation"
                     tape="REWIND" record="OFF" index="OFF">
               </ROAD>
                <ROAD 
                    name="DeleteCustomerRetry"
                    letter="Retry"
                    destination="DeleteBusinessInfo"
                    tape="REWIND"
                    record="OFF"
                    index="OFF">
                </ROAD>              
               <ROAD name="DeleteBusinessCancel"
                     letter="Cancel"
                     destination="Final"
                     tape="ADVANCE" record="OFF" index="OFF">
               </ROAD>
          </SITE>
          
          <SITE name="CheckCustomerType" siteaction="CheckCustomerTypeSite">
               <COMMENT>
                   Check whether the customer is business or regular.
               </COMMENT>
               <ROAD name="CheckCustomerTypeRegCustomer"
                    letter="RegCustomer"
                    destination="DeleteCustomerInfo"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                    <COMMENT>
                        This road is traversed when the customer is regular.
                    </COMMENT>
               </ROAD>
               <ROAD name="CheckCustomerTypeBusiness"
                     letter="BusCustomer"
                     destination="DeleteBusinessInfo"
                     tape="ADVANCE"
                     record="OFF"
                     index="OFF">
                     <COMMENT>
                         This road is traversed when the customer is business.
                     </COMMENT>
               </ROAD>
          </SITE>
          

            <SYSTEMSITE  name="Final" action="RETURN"/>
            <SYSTEMSITE  name="LastIndexed" action="BACKUP"/>
        </REGION>
    </MAP>
</SERVICE>
