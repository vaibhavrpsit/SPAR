<?xml version='1.0' ?>
<!--
/* ===========================================================================
* Copyright (c) 2009, 2013, Oracle and/or its affiliates. All rights reserved.
 * ===========================================================================
 * $Header: rgbustores/applications/pos/src/oracle/retail/stores/pos/services/modifyitem/modifyitem.xml /main/25 2013/05/29 12:10:25 yiqzhao Exp $
 * ===========================================================================
 * NOTES
 * <other useful comments, qualifications, etc.>
 *
 * MODIFIED    (MM/DD/YY)
 *    yiqzhao   05/28/13 - Take Done letter to modify item screen.
 *    yiqzhao   02/27/13 - Add related item return shuttle.
 *    yiqzhao   02/26/13 - Check for order item after adding related item(s).
 *    cgreene   12/05/12 - remove menu=true so that buttons do not paint
 *                         triangle
 *    yiqzhao   09/26/12 - refactor related item to add cross sell, upsell and
 *                         substitute, remove pick one and pick many
 *    yiqzhao   08/31/12 - add XChannelCreatePickupLaunchShuttle.
 *    yiqzhao   06/29/12 - Add dialog for deleting ship item, disable change
 *                         price for ship item
 *    yiqzhao   06/22/12 - add roads from ship stations
 *    jswan     05/14/12 - Modified to support Ship button feature.
 *    jswan     04/18/12 - Modified to support cross channel create pickup
 *                         order feature.
 *    jswan     04/13/12 - Modified to support cross channel created order for
 *                         pickup.
 *    cgreene   05/26/10 - convert to oracle packaging
 *    cgreene   04/27/10 - XbranchMerge cgreene_refactor-duplicate-pos-classes
 *                         from st_rgbustores_techissueseatel_generic_branch
 *    cgreene   03/26/10 - move timeout road to common service
 *    abondala  01/02/10 - Update Header date
 *    abondala  12/16/09 - Added ADE Header
 *
 * ===========================================================================
 */
-->
<!DOCTYPE SERVICE SYSTEM "classpath://oracle/retail/stores/foundation/tour/dtd/tourguide.dtd">

<SERVICE
    name="ModifyItem"
    package="oracle.retail.stores.pos.services.modifyitem"
    tourcam="OFF">
    <COMMENT>
        This service implements the modify item use case
        and the use cases it calls.
    </COMMENT>
    <CARGO class="ItemCargo" package="oracle.retail.stores.pos.services.modifyitem">
        <COMMENT>
            This cargo contains a clone of the item to be modified.
        </COMMENT>
    </CARGO>
    <SERVICECODE>
        <LETTER name="Failure"/>
        <LETTER name="Services"/>
        <LETTER name="Add"/>
        <LETTER name="Help"/>
        <LETTER name="Components"/>
        <LETTER name="No"/>
        <LETTER name="Success"/>
        <LETTER name="Cancel"/>
        <LETTER name="Clear"/>
        <LETTER name="Invalid"/>
        <LETTER name="ActivationCancelled"/>
        <LETTER name="GiftCardInquiry"/>
        <LETTER name="GiftRegistry"/>
        <LETTER name="IDError"/>
        <LETTER name="Inquiry"/>
        <LETTER name="InquiryReturnLetter"/>
        <LETTER name="Quantity"/>
        <LETTER name="SerialNumber"/>
        <LETTER name="Default"/>
        <LETTER name="Undo"/>
        <LETTER name="Next"/>
        <LETTER name="SalesAssociate"/>
        <LETTER name="Ok"/>
        <LETTER name="Tax"/>
        <LETTER name="Yes"/>
        <LETTER name="Continue"/>
        <LETTER name="GiftReceipt"/>
        <LETTER name="Send"/>
        <LETTER name="Override"/>
        <LETTER name="Loop"/>
        <LETTER name="Alterations"/>
        <LETTER name="GiftReceiptEligible"/>
        <LETTER name="Done"/>
        <LETTER name="ShippingMethod"/>
        <LETTER name="Pickup"/>
        <LETTER name="Delivery"/>
        <LETTER name="Error"/>
        <LETTER name="RelatedItem"/>
        
        <!-- Shuttle -->
        <SHUTTLE class="SecurityOverrideLaunchShuttle" package="oracle.retail.stores.pos.services.admin.security.common"/>
        <SHUTTLE class="InquiryOptionsReturnShuttle"/>
        <SHUTTLE class="InquiryOptionsLaunchShuttle"/>
        <SHUTTLE class="ModifyItemTaxLaunchShuttle"/>
        <SHUTTLE class="ModifyItemTaxReturnShuttle"/>
        <SHUTTLE class="GiftCardInquiryLaunchShuttle"/>
        <SHUTTLE class="GiftCardInquiryReturnShuttle"/>
        <SHUTTLE class="KitComponentsLaunchShuttle"/>
        <SHUTTLE class="KitComponentsReturnShuttle"/>
        <SHUTTLE class="ModifyItemSerialNumberLaunchShuttle"/>
        <SHUTTLE class="ModifyItemSendLaunchShuttle"/>
        <SHUTTLE class="ModifyItemSendReturnShuttle"/>
        <SHUTTLE class="AlterationsLaunchShuttle"/>
        <SHUTTLE class="AlterationsReturnShuttle"/>
        <SHUTTLE class="DisplaySendMethodLaunchShuttle"/>
        <SHUTTLE class="XChannelCreatePickupLaunchShuttle"/>
        <SHUTTLE class="XChannelCreatePickupReturnShuttle"/>
        <SHUTTLE class="XChannelCreateShippingLaunchShuttle"/>
        <SHUTTLE class="XChannelCreateShippingReturnShuttle"/>
        
        <SHUTTLE class="PickupLaunchShuttle" package="oracle.retail.stores.pos.services.modifyitem"/>
        <SHUTTLE class="PickupReturnShuttle" package="oracle.retail.stores.pos.services.modifyitem"/>
        <SHUTTLE class="DeliveryLaunchShuttle" package="oracle.retail.stores.pos.services.modifyitem"/>
        <SHUTTLE class="DeliveryReturnShuttle" package="oracle.retail.stores.pos.services.modifyitem"/>
        <SHUTTLE class="RelatedItemLaunchShuttle"/>
        <SHUTTLE class="RelatedItemReturnShuttle"/>

        <LANEACTION class="ItemQuantityModifiedAisle"/>
        <LANEACTION class="PriceEnteredAisle" package="oracle.retail.stores.pos.services.common"/>
        <LANEACTION class="SetAccessRoleRoad"/>
        <LANEACTION class="DontAttachItemGiftRegistryAisle" package="oracle.retail.stores.pos.services.modifyitem"/>
        <LANEACTION class="FailureConversionAisle" package="oracle.retail.stores.pos.services.common"/>
        <LANEACTION class="AttachItemGiftRegistryAisle" package="oracle.retail.stores.pos.services.modifyitem"/>
        <LANEACTION class="ItemSerialModifiedAisle"/>
        <LANEACTION class="UndoItemInquiryAisle"/>
        <LANEACTION class="ServiceItemsErrorAisle"/>
        <LANEACTION class="ServiceItemSelectedAisle"/>
        <LANEACTION class="NextLetterAisle" package="oracle.retail.stores.pos.services.common"/>
        <LANEACTION class="ItemPriceModifiedAisle"/>
        <LANEACTION class="ItemGiftRegistryModifiedAisle"/>
        <LANEACTION class="GiftReceiptAssignedAisle"/>
        <LANEACTION class="GiftReceiptCheckEligibilityAisle"/>
        <LANEACTION class="CancelLetterAisle" package="oracle.retail.stores.pos.services.common"/>
        
        <SITEACTION class="ModifyItemSite"/>
        <SITEACTION class="LookupServiceItemsSite"/>
        <SITEACTION class="ModifyItemSalesAssociateSite"/>
        <SITEACTION class="AddItemSite"/>
        <SITEACTION class="ValidateSalesAssociateSite"/>
        <SITEACTION class="CheckPriceEntrySite" package="oracle.retail.stores.pos.services.common"/>
        <SITEACTION class="SelectServiceItemSite"/>
        <SITEACTION class="ModifyItemQuantitySite"/>
        <SITEACTION class="ItemCheckReturnLetterSite"/>
        <SITEACTION class="ModifyItemGiftRegistrySite"/>
        <SITEACTION class="CheckAccessSite" package="oracle.retail.stores.pos.services.admin.security.common"/>

        <SIGNAL     class="IsXChannelOrderSignal" package="oracle.retail.stores.pos.services.common"/>

    </SERVICECODE>
    <MAP>
        <REGION region="SERVICE" startsite="ModifyItemMenu">
           <SITE name="CheckAccess" siteaction="CheckAccessSite">
              <ROAD
                  name="AccessDEnied"
                  letter="Override"
                  destination="SecurityOverrideStation"
                  tape="ADVANCE" record="OFF" index="OFF">
              </ROAD>
              <ROAD
                  name="AccessGranted"
                  letter="Continue"
                  destination="CheckReturnLetter"
                  tape="ADVANCE" record="OFF" index="OFF">
              </ROAD>

          </SITE>
          <STATION name="SecurityOverrideStation"
              servicename="security.override.override"
              targettier="CURRENTTIER"
              launchshuttle="SecurityOverrideLaunchShuttle" >
              <ROAD
                  name="SecurityOverrideGranted"
                  letter="Success"
                  destination="CheckReturnLetter"
                  tape="ADVANCE" record="OFF" index="OFF">
              </ROAD>
              <ROAD
                  name="SecurityOverrideDenied"
                  letter="Failure"
                  destination="ModifyItemMenu"
                  tape="ADVANCE" record="OFF" index="OFF">
              </ROAD>
              <ROAD
                  name="SecurityOverrideCancelled"
                  letter="Cancel"
                  destination="Final"
                  tape="ADVANCE" record="OFF" index="OFF">
              </ROAD>
           </STATION>
           <SITE name="ModifyItemMenu" siteaction="ModifyItemSite">
                <AISLE
                    name="GiftReceiptCheckEligibility"
                    letter="GiftReceipt"
                    laneaction="GiftReceiptCheckEligibilityAisle">
                    <COMMENT>
                        Show diaglog screen if not all items are eligible,
                        then flow continues.
                    </COMMENT>
                </AISLE>
                <AISLE
                    name="GiftReceiptSelected"
                    letter="GiftReceiptEligible"
                    laneaction="GiftReceiptAssignedAisle">
                    <COMMENT>
                        This aisle will assign a gift receipt attribute to
                        the SaleReturnLineItem and mail the Final letter,
                        Next to the calling service.
                    </COMMENT>
                </AISLE>
                <ROAD
                    name="UndoModifyItemMenu"
                    letter="Undo"
                    destination="Final"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                </ROAD>

                <ROAD
                    name="ItemGiftRegistry"
                    letter="GiftRegistry"
                    laneaction="SetAccessRoleRoad"
                    destination="CheckAccess"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                </ROAD>
                <ROAD
                    name="ItemQuantity"
                    letter="Quantity"
                    destination="ModifyItemQuantity"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                </ROAD>
                <ROAD
                    name="InquiryOptions"
                    letter="Inquiry"
                    destination="InquiryOptionsStation"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                </ROAD>
                <ROAD
                    name="ItemSalesAssociate"
                    letter="SalesAssociate"
                    laneaction="SetAccessRoleRoad"
                    destination="CheckAccess"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                </ROAD>
                <ROAD
                    name="ItemTax"
                    letter="Tax"
                    destination="ModifyItemTaxStation"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                </ROAD>
                <ROAD
                    name="ServicesSelected"
                    letter="Services"
                    destination="LookupServiceItems"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                </ROAD>
                <ROAD
                    name="InquiryGiftCard"
                    letter="GiftCardInquiry"
                    destination="GiftCardInquiryStation"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                </ROAD>
                <ROAD
                    name="ModifySerialNumber"
                    letter="SerialNumber"
                    destination="SerializedItemStation"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                </ROAD>
                <ROAD
                    name="SendSelected"
                    letter="Send"
                    destination="ModifyItemSendStation"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                </ROAD>
                <ROAD
                    name="DisplayComponentOptionsRoad"
                    letter="Components"
                    destination="ModifyKitComponentsStation"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                </ROAD>
                <ROAD
                    name="ModifyAlterationsSelected"
                    letter="Alterations"
                    destination="ModifyAlterationsStation"
                    tape="ADVANCE"
                    record="ON"
                    index="ON">
                </ROAD>
			    <ROAD
                   name="PickupSelected"
                   letter="Pickup"
                   destination="PickupStation"
                   tape="ADVANCE"
                   record="ON"
                   index="ON">
                   <LIGHT signal="IsXChannelOrderSignal" negate="Y"/>
               </ROAD>
                <ROAD
                   name="XChannelPickupSelected"
                   letter="Pickup"
                   destination="XChannelCreatePickupOrderStation"
                   tape="ADVANCE"
                   record="ON"
                   index="ON">
                    <LIGHT signal="IsXChannelOrderSignal"/>
               </ROAD>
			   <ROAD
                   name="DeliverySelected"
                   letter="Delivery"
                   destination="DeliveryStation"
                   tape="ADVANCE"
                   record="ON"
                   index="ON">
                   <LIGHT signal="IsXChannelOrderSignal" negate="Y"/>
               </ROAD>
               <ROAD
                   name="ShippingSelected"
                   letter="Delivery"
                   destination="XChannelCreateShippingOrderStation"
                   tape="ADVANCE"
                   record="ON"
                   index="ON">
                   <LIGHT signal="IsXChannelOrderSignal"/>
               </ROAD>
               <ROAD
                    name="RelatedItemSelected"
                    letter="RelatedItem"
                    destination="RelatedItemStation"
                    tape="ADVANCE"
                    record="ON"
                    index="ON">
               </ROAD>               
            </SITE>
            <STATION
                   name="PickupStation"
                   servicename="services.pickup.pickup"
                   targettier="CURRENTTIER"
                   launchshuttle="PickupLaunchShuttle"
                   returnshuttle="PickupReturnShuttle">
                    <COMMENT >
                        This station sends an alteration item                                                                                        to the Alterations
                        Service for modification.
                    </COMMENT>
               <ROAD
                    name="ModifyPickupCompleted"
                    letter="Continue"
                    destination="Final"
                    tape="ADVANCE"
                    record="ON"
                    index="ON">
              </ROAD>
              <ROAD
                    name="ModifyPickupCanceled"
                    letter="Cancel"
                    destination="Final"
                    tape="ADVANCE"
                    record="ON"
                    index="ON">
              </ROAD>
              <ROAD
                    name="ModifyPickupUndone"
                    letter="Undo"
                    destination="ModifyItemMenu"
                    tape="ADVANCE"
                    record="ON"
                    index="ON">
              </ROAD>
            </STATION>
            <STATION
                   name="XChannelCreatePickupOrderStation"
                   servicename="services.order.xchannelpickup"
                   targettier="CURRENTTIER"
                   launchshuttle="XChannelCreatePickupLaunchShuttle"
                   returnshuttle="XChannelCreatePickupReturnShuttle">
                    <COMMENT >
                        This station sends the selected items to the
                        cross channel pickup order create tour.
                    </COMMENT>
               <ROAD
                    name="XChannelModifyPickupCompleted"
                    letter="Continue"
                    destination="Final"
                    tape="ADVANCE"
                    record="ON"
                    index="ON">
              </ROAD>
              <ROAD
                    name="XChannelModifyPickupCanceled"
                    letter="Cancel"
                    destination="Final"
                    tape="ADVANCE"
                    record="ON"
                    index="ON">
              </ROAD>
              <ROAD
                    name="XChannelModifyPickupUndone"
                    letter="Undo"
                    destination="ModifyItemMenu"
                    tape="ADVANCE"
                    record="ON"
                    index="ON">
              </ROAD>
              <ROAD
                    name="XChannelModifyPickupErorr"
                    letter="Error"
                    destination="ModifyItemMenu"
                    tape="ADVANCE"
                    record="ON"
                    index="ON">
              </ROAD>
            </STATION>

            <STATION
                    name="XChannelCreateShippingOrderStation"
                    servicename="services.order.xchannelshipping"
                    targettier="CURRENTTIER"
                    launchshuttle="XChannelCreateShippingLaunchShuttle"
                    returnshuttle="XChannelCreateShippingReturnShuttle">
                <ROAD
                    name="CreateShippingOrderStationContinue"
                    letter="Continue"
                    destination="Final"
                    tape="ADVANCE"
                    record="OFF"
                    index="ON">
                </ROAD>
                <ROAD
                    name="CreateShippingOrderStationCancel"
                    letter="Cancel"
                    destination="Final"
                    tape="ADVANCE"
                    record="OFF"
                    index="ON">
                </ROAD>
                <ROAD
                    name="CreateShippingOrderStationUndo"
                    letter="Undo"
                    destination="ModifyItemMenu"
                    tape="ADVANCE"
                    record="OFF"
                    index="ON">
                </ROAD>                                                     
                <ROAD
                    name="CreateShippingOrderStationError"
                    letter="Error"
                    destination="ModifyItemMenu"
                    tape="ADVANCE"
                    record="OFF"
                    index="ON">
                </ROAD>
                <ROAD
                    name="CreateShippingOrderStationDone"
                    letter="Done"
                    destination="Final"
                    tape="ADVANCE"
                    record="OFF"
                    index="ON">
                </ROAD>                                
            </STATION>

            <STATION
                    name="DeliveryStation"
                    servicename="services.delivery.delivery"
                    targettier="CURRENTTIER"
                    launchshuttle="DeliveryLaunchShuttle"
                    returnshuttle="DeliveryReturnShuttle">
                    <COMMENT >
                        This station sends an alteration item to the Alterations
                        Service for modification.
                    </COMMENT>
               <ROAD
                    name="ModifyDeliveryCompleted"
                    letter="Continue"
                    destination="Final"
                    tape="ADVANCE"
                    record="ON"
                    index="ON">
               </ROAD>
               <ROAD
                    name="ModifyDeliveryCanceled"
                    letter="Cancel"
                    destination="Final"
                    tape="ADVANCE"
                    record="ON"
                    index="ON">
               </ROAD>
               <ROAD
                    name="ModifyDeliveryUndone"
                    letter="Undo"
                    destination="ModifyItemMenu"
                    tape="ADVANCE"
                    record="ON"
                    index="ON">
               </ROAD>
            </STATION>
            <STATION
                    name="ModifyKitComponentsStation"
                    servicename="modifyitem.kit.components"
                    targettier="CURRENTTIER"
                    launchshuttle="KitComponentsLaunchShuttle"
                    returnshuttle="KitComponentsReturnShuttle">
               <ROAD
                    name="UndoComponentOptions"
                    letter="Undo"
                    destination="ModifyItemMenu"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                    <COMMENT>
                        This road is traveled when the Kit Components service
                        returns with an Undo letter.
                    </COMMENT>
                </ROAD>
                <ROAD
                    name="ComponentOptionsOk"
                    letter="Ok"
                    destination="ModifyItemMenu"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                </ROAD>
                <ROAD
                    name="ComponentOptionsNext"
                    letter="Next"
                    destination="ModifyItemMenu"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                </ROAD>
                <ROAD
                    name="CancelKitComponents"
                    letter="Cancel"
                    destination="Final"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                    <COMMENT>
                        This road goes to the Final site.
                    </COMMENT>
                </ROAD>
                <ROAD
                    name="ComponentOptionsClear"
                    letter="Clear"
                    destination="ModifyItemMenu"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                </ROAD>
            </STATION>
            <SITE name="ModifyItemQuantity" siteaction="ModifyItemQuantitySite">
                <COMMENT>
                    This site implements steps 2, and 3 of the modify item
                    quantity use case. Prompt for the new quantity. A
                    null quantity will not be allowed by the UI. Store
                    the user specified quantity as the new item quantity.
                    Record the new quantity for this item in the journal.
                    Set transaction-item? in return shuttle . Actual
                    updating of quantity and totals is done in the business
                    object. Mail final letter to parent.
                </COMMENT>
                <AISLE
                    name="ItemQuantityModified"
                    letter="Next"
                    laneaction="ItemQuantityModifiedAisle">
                    <COMMENT>
                        Get UI input Put it into cargo Mail final letter to
                        parent.
                    </COMMENT>
                </AISLE>
                <ROAD
                    name="UpdateShippingMethod"
                    letter="ShippingMethod"
                    destination="DisplaySendMethodStation"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                    <COMMENT>
                        Update shipping method if the item is send item.
                    </COMMENT>
                </ROAD>
                <ROAD
                    name="RetryItemQuantity"
                    letter="Loop"
                    destination="ModifyItemQuantity"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                    <COMMENT>
                        traversed it and invalid quantity is entered.
                        returns to item quantitny screen to reenter quantity
                    </COMMENT>
                </ROAD>

                <ROAD
                    name="CancelItemQuantity"
                    letter="Cancel"
                    destination="Final"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                    <COMMENT>
                        send a final letter with a parm telling the parent
                        to give up
                    </COMMENT>
                </ROAD>
                <ROAD
                    name="UndoItemQuantity"
                    letter="Undo"
                    destination="ModifyItemMenu"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                    <COMMENT>
                        Go to the main item menu options.
                    </COMMENT>
                </ROAD>
            </SITE>
            <SITE name="ModifyItemSalesAssociate" siteaction="ModifyItemSalesAssociateSite">
                <COMMENT>
                    This site implements steps 2, and 3 of the modify item
                    sales associate use case. Prompt for the new sales
                    associate. The current sales associate will be the
                    default for the prompt. The user enters a sales associate
                    or clears the default. If the default is cleared,
                    the cashier is set as the new sales associate for the
                    item. Store the user specified sales associate as
                    the new sales associate for the selected item. Record
                    the new sales associate for this item in the journal.
                    Set transaction-item? in return shuttle Mail final
                    letter to parent.
                </COMMENT>
                <ROAD
                    name="CancelItemSalesAssociate"
                    letter="Cancel"
                    destination="Final"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                    <COMMENT>
                        send a final letter with a parm telling the parent
                        to give up
                    </COMMENT>
                </ROAD>
                <ROAD
                    name="UndoItemSalesAssociate"
                    letter="Undo"
                    destination="ModifyItemMenu"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                    <COMMENT>
                        Go back to the Main Modify items menu.
                    </COMMENT>
                </ROAD>
                <ROAD
                    name="SalesAssociateModified"
                    letter="Next"
                    destination="ValidateSalesAssociate"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                </ROAD>
            </SITE>
            <STATION
                name="InquiryOptionsStation"
                servicename="services.inquiry.inquiryoptions"
                targettier="CURRENTTIER"
                launchshuttle="InquiryOptionsLaunchShuttle"
                returnshuttle="InquiryOptionsReturnShuttle">
                <COMMENT>
                    This station is the transfer point for the InquiryOptions
                    service.
                </COMMENT>
                <ROAD
                    name="InquiryReturned"
                    letter="Next"
                    destination="Final"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                    <COMMENT>
                        This road is traveled when the Inquiry Options service
                        returns.
                    </COMMENT>
                </ROAD>
                <ROAD
                    name="InquiryDoneReturned"
                    letter="Done"
                    destination="ModifyItemMenu"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                    <COMMENT>
                        This road is traveled when the Inquiry Options service
                        returns.
                    </COMMENT>
                </ROAD>                
                <ROAD
                    name="UndoInquiry"
                    letter="Undo"
                    destination="ModifyItemMenu"
                    laneaction="UndoItemInquiryAisle"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                    <COMMENT>
                        This road is traveled when the Item Inquiry service
                        returns with an Undo letter.
                    </COMMENT>
                </ROAD>
                <ROAD
                    name="CamcelMenuInquiry"
                    letter="CancelMenu"
                    destination="ModifyItemMenu"
                    laneaction="UndoItemInquiryAisle"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                    <COMMENT>
                        This road is traveled when the Item Inquiry service
                        returns with an CancelMenu letter.
                    </COMMENT>
                </ROAD>
                <ROAD
                    name="AddItemToTransaction"
                    letter="Add"
                    destination="Final"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                    <COMMENT>
                        This road is traveled when the Item Inquiry service
                        returns with an Add letter.
                    </COMMENT>
                </ROAD>
                <ROAD
                    name="CancelEntered"
                    letter="Cancel"
                    destination="Final"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                    <COMMENT>
                        This road goes to the Final site.
                    </COMMENT>
                </ROAD>
                <ROAD
                    name="AccessDenied"
                    letter="Failure"
                    destination="ModifyItemMenu"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                    <COMMENT>
                        This road goes to the Final site.
                    </COMMENT>
                </ROAD>
                <ROAD
                    name="InvalidAgeForItem"
                    letter="Invalid"
                    destination="Final"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                </ROAD>
            </STATION>

            <SITE name="ModifyItemGiftRegistry" siteaction="ModifyItemGiftRegistrySite">
                <COMMENT>
                    This site implements steps 2, 3, and 4 of the modify
                    item gift registry use caseflow. Prompt for new gift
                    registry number. Store the user specified gift registry
                    number in the item. Update the item with new gift registry
                    number according to the transaction policy. Record
                    the registry number and gift item information in
                    the journal. Set transaction-item? in return shuttle
                    Mail final letter to parent.
                </COMMENT>
                <AISLE
                    name="ItemGiftRegistryModified"
                    letter="Next"
                    laneaction="ItemGiftRegistryModifiedAisle">
                    <COMMENT>
                        Get UI input. Put it into cargo. Mail final letter
                        to parent.
                    </COMMENT>
                </AISLE>
                <AISLE
                    name="DontAttachItemGiftRegistry"
                    letter="No"
                    laneaction="DontAttachItemGiftRegistryAisle">
                </AISLE>
                <AISLE
                    name="AttachItemGiftRegistry"
                    letter="Yes"
                    laneaction="AttachItemGiftRegistryAisle">
                </AISLE>
                <ROAD
                    name="CancelItemGiftRegistry"
                    letter="Cancel"
                    destination="Final"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                    <COMMENT>
                        send a final letter with a parm telling the parent
                        to give up
                    </COMMENT>
                </ROAD>
                <ROAD
                    name="UndoItemGiftRegistry"
                    letter="Undo"
                    destination="ModifyItemMenu"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                    <COMMENT>
                        This road goes to the Main Modify Item Menu.
                    </COMMENT>
                </ROAD>
                <ROAD
                    name="ItemRegistryOkEntered"
                    letter="Ok"
                    destination="ModifyItemGiftRegistry"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                </ROAD>
                <ROAD
                    name="ItemRegistryYesEntered"
                    letter="Yes"
                    destination="ModifyItemMenu"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                </ROAD>
                <ROAD
                    name="ItemRegistryNoEntered"
                    letter="No"
                    destination="ModifyItemMenu"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                </ROAD>
            </SITE>

            <STATION
                name="ModifyItemTaxStation"
                servicename="modifyitem.tax.ModifyItemTax"
                targettier="CURRENTTIER"
                launchshuttle="ModifyItemTaxLaunchShuttle"
                returnshuttle="ModifyItemTaxReturnShuttle">
                <COMMENT>
                    This station goes to the Modify Tax Service.
                </COMMENT>
                <ROAD
                    name="SuccessfulChange"
                    letter="Success"
                    destination="Final"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                    <COMMENT>
                        This road is traversed when a successful change is made.
                    </COMMENT>
                </ROAD>
                <ROAD
                    name="MulitpleItemTaxChangeNo"
                    letter="No"
                    destination="ModifyItemMenu"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                    <COMMENT>
                        This road is traversed when the user chooses to not make a tax change to
                        entry(s) that have already been changed.
                    </COMMENT>
                </ROAD>
                <ROAD
                    name="NextTax"
                    letter="Next"
                    destination="Final"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                    <COMMENT>
                        This road is traversed when a Next letter is received
                    </COMMENT>
                </ROAD>
                <ROAD
                    name="CancelTax"
                    letter="Cancel"
                    destination="Final"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                    <COMMENT>
                        This road is traversed when the Cancel Letter is received.
                    </COMMENT>
                </ROAD>
                <ROAD
                    name="AccessFailureTax"
                    letter="Failure"
                    destination="ModifyItemMenu"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                    <COMMENT>
                        This road is traversed when the Failure Letter is received.
                    </COMMENT>
                </ROAD>
                <ROAD
                    name="UndoTax"
                    letter="Undo"
                    destination="ModifyItemMenu"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                    <COMMENT>
                        This road is traversed when a Undo letter is received
                        from the Modify Item Tax service.
                    </COMMENT>
                </ROAD>
            </STATION>
            <SITE name="LookupServiceItems" siteaction="LookupServiceItemsSite">
                <COMMENT>
                    Retrieves a list of service items from the data source.
                </COMMENT>
                <AISLE
                    name="NoServiceItemsFound"
                    letter="Failure"
                    laneaction="ServiceItemsErrorAisle">
                    <COMMENT>
                        This aisle is traversed is no service items are found.
                    </COMMENT>
                </AISLE>
                <AISLE
                    name="NoServiceItemsAcknowledged"
                    letter="Ok"
                    laneaction="NextLetterAisle">
                </AISLE>
                <ROAD
                    name="ServiceItemsFound"
                    letter="Success"
                    destination="SelectServiceItem"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                    <COMMENT>
                        This road is traveled if there are service items.
                    </COMMENT>
                </ROAD>
                <ROAD
                    name="NoServices"
                    letter="Next"
                    destination="Final"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                    <COMMENT>
                        This road is traveled if there are no service items.
                    </COMMENT>
                </ROAD>
            </SITE>
            <SITE name="CheckReturnLetter" siteaction="ItemCheckReturnLetterSite">
                <ROAD
                    name="ReturnGiftRegistry"
                    letter="GiftRegistry"
                    destination="ModifyItemGiftRegistry"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                </ROAD>
                <ROAD
                    name="ReturnSalesAssociate"
                    letter="SalesAssociate"
                    destination="ModifyItemSalesAssociate"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                </ROAD>
                <ROAD
                    name="ReturnDefault"
                    letter="Default"
                    destination="ModifyItemMenu"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                </ROAD>
            </SITE>
            <SITE name="SelectServiceItem" siteaction="SelectServiceItemSite">
                <AISLE
                    name="ServiceItemSelected"
                    letter="Next"
                    laneaction="ServiceItemSelectedAisle">
                    <COMMENT>
                        Stores the selected item in the cargo
                    </COMMENT>
                </AISLE>
                <ROAD
                    name="NextServiceItem"
                    letter="Continue"
                    destination="CheckPriceEntry"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                </ROAD>
                <ROAD
                    name="AlterationsSelected"
                    letter="Alterations"
                    destination="AlterationStation"
                    tape="ADVANCE"
                    record="ON"
                    index="ON">
                </ROAD>
                <ROAD
                    name="CancelServices"
                    letter="Cancel"
                    destination="Final"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                </ROAD>
                <ROAD
                    name="UndoServices"
                    letter="Undo"
                    destination="ModifyItemMenu"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                </ROAD>
            </SITE>
            <SITE name="CheckPriceEntry" siteaction="CheckPriceEntrySite">
                <COMMENT>
                    This site checks to see if price entry is required
                    for the item.
                </COMMENT>
                <AISLE
                    name="PriceEntered"
                    letter="Next"
                    laneaction="PriceEnteredAisle">
                    <COMMENT>
                        This aisle is traversed when the user presses the
                        Next key in the ENTER_PRICE screen.
                    </COMMENT>
                </AISLE>
                <ROAD
                    name="HasPrice"
                    letter="Continue"
                    destination="AddItem"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                    <COMMENT>
                        This road is traveled when the Item has a price.
                    </COMMENT>
                </ROAD>
                <ROAD
                    name="UndoPrice"
                    letter="Undo"
                    destination="SelectServiceItem"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                    <COMMENT>
                        This road is traveled when the user presses the Undo
                        key in the ENTER_PRICE menu.
                    </COMMENT>
                </ROAD>
                <ROAD
                    name="CancelPrice"
                    letter="Cancel"
                    destination="Final"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                    <COMMENT>
                        This road is traveled when the user presses the Cancel
                        key from the ENTER_PRICE screen.
                    </COMMENT>
                </ROAD>
            </SITE>
            <SITE name="AddItem" siteaction="AddItemSite">
                <COMMENT>
                    This site updates the transaction with the new item
                </COMMENT>
                <AISLE
                    name="ItemAddedContinue"
                    letter="Continue"
                    laneaction="NextLetterAisle">
                </AISLE>
                <ROAD
                    name="ItemAddedNext"
                    letter="Next"
                    destination="Final"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                    <COMMENT>
                        This road is traversed when the Item has been added
                        to the transaction.
                    </COMMENT>
                </ROAD>
            </SITE>

            <SITE name="ValidateSalesAssociate" siteaction="ValidateSalesAssociateSite">
                <ROAD
                    name="ValidSalesAssociate"
                    letter="Next"
                    destination="Final"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                </ROAD>
                <ROAD
                    name="InValidSalesAssociate"
                    letter="Ok"
                    destination="ModifyItemSalesAssociate"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                </ROAD>
            </SITE>

            <STATION
                name="GiftCardInquiryStation"
                servicename="inquiry.giftcardinquiry.inquiry"
                targettier="CURRENTTIER"
                launchshuttle="GiftCardInquiryLaunchShuttle">
                <AISLE name="ConvertActivationCancelledToCancel"
                       letter="ActivationCancelled"
                       laneaction="CancelLetterAisle">
                </AISLE>
                <ROAD
                    name="GiftCardInquiryCompleted"
                    letter="Next"
                    destination="Final"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                </ROAD>
                <ROAD
                    name="UndoGiftCardInquiry"
                    letter="Undo"
                    destination="ModifyItemMenu"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                </ROAD>
                <ROAD
                    name="CancelGiftCardInquiry"
                    letter="Cancel"
                    destination="Final"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                </ROAD>
                <ROAD
                    name="FailedGiftCardInquiry"
                    letter="Failure"
                    destination="ModifyItemMenu"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                </ROAD>
            </STATION>
            <STATION
                 name="SerializedItemStation"
                 servicename="modifyitem.serialnumber.serializedItem"
                 targettier="CURRENTTIER"
                 launchshuttle="ModifyItemSerialNumberLaunchShuttle">
                 <COMMENT>
                     This service prompts the user for serial number input and sets the serial number attribute
                     for one or more line items.
                 </COMMENT>
                 <ROAD
                     name="SerializedItemUndo"
                     letter="Undo"
                     destination="ModifyItemMenu">
                 </ROAD>
                 <ROAD
                     name="SerializedItemCancel"
                     letter="Cancel"
                     destination="Final">
                 </ROAD>
                 <ROAD
                     name="SerialNumbersEntered"
                     letter="Ok"
                     destination="Final">
                 </ROAD>
            </STATION>

            <STATION
                 name="ModifyItemSendStation"
                 servicename="services.send.send"
                 targettier="CURRENTTIER"
                 launchshuttle="ModifyItemSendLaunchShuttle"
                 returnshuttle="ModifyItemSendReturnShuttle">
                 <COMMENT>
                      This station is the transfer point for the send
                      service.
                 </COMMENT>
                 <ROAD
                    name="NonMerchandiseItemFound"
                    letter="Ok"
                    destination="Final"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                </ROAD>
                <ROAD
                    name="SendSuccessfullyCompleted"
                    letter="Done"
                    destination="Final"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                </ROAD>
                <ROAD
                    name="UndoPressedDuringCutomerLink"
                    letter="Undo"
                    destination="Final"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                </ROAD>
                <ROAD
                    name="CancelPressedDuringCutomerLink"
                    letter="Cancel"
                    destination="Final"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                </ROAD>
                <ROAD
                    name="CustomerIDEnteredDuringCutomerLink"
                    letter="Continue"
                    destination="Final"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                </ROAD>
                <ROAD
                    name="CustomerAlreadyLinked"
                    letter="Success"
                    destination="Final"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                </ROAD>
                <ROAD
                    name="CustomerNotLinked"
                    letter="Failure"
                    destination="Final"
                    tape="ADVANCE"
                    record="OFF"
                    index="OFF">
                </ROAD>
            </STATION>
            <STATION
                name="AlterationStation"
                servicename="services.alterations.alterations"
                targettier="CURRENTTIER"
                launchshuttle="AlterationsLaunchShuttle"
                returnshuttle="AlterationsReturnShuttle">
                 <ROAD
                    name="AlterationsCompleted"
                    letter="Continue"
                    destination="Final"
                    tape="ADVANCE"
                    record="ON"
                    index="ON">
                </ROAD>
                <ROAD
                    name="UndoAlterations"
                    letter="Undo"
                    destination="SelectServiceItem"
                    tape="ADVANCE"
                    record="ON"
                    index="ON">
                </ROAD>
                <ROAD
                    name="CancelAlterations"
                    letter="Cancel"
                    destination="Final"
                    tape="ADVANCE"
                    record="ON"
                    index="ON">
                </ROAD>
                <ROAD
                    name="CancelAlterationsNoCustomer"
                    letter="No"
                    destination="SelectServiceItem"
                    tape="ADVANCE"
                    record="ON"
                    index="ON">
                </ROAD>
            </STATION>
            <STATION
                name="ModifyAlterationsStation"
                servicename="services.alterations.alterations"
                targettier="CURRENTTIER"
                launchshuttle="AlterationsLaunchShuttle"
                returnshuttle="AlterationsReturnShuttle">
                <COMMENT >
                    This station sends an alteration item to the Alterations
                    Service for modification.
                </COMMENT>
                <ROAD
                    name="ModifyAlterationsCompleted"
                    letter="Continue"
                    destination="Final"
                    tape="ADVANCE"
                    record="ON"
                    index="ON">
                </ROAD>
                <ROAD
                    name="ModifyAlterationsCanceled"
                    letter="Cancel"
                    destination="Final"
                    tape="ADVANCE"
                    record="ON"
                    index="ON">
                </ROAD>
                <ROAD
                    name="ModifyAlterationsUndone"
                    letter="Undo"
                    destination="ModifyItemMenu"
                    tape="ADVANCE"
                    record="ON"
                    index="ON">
                </ROAD>
            </STATION>
            <STATION
                name="DisplaySendMethodStation"
                servicename="send.displaysendmethod.displaysendmethod"
                targettier="CURRENTTIER"
                launchshuttle="DisplaySendMethodLaunchShuttle">
                <COMMENT>
                    This station goes to the display send method station for updating
                    shipping method.
                </COMMENT>
                <AISLE
                    name="DoneSelectedAisle"
                    letter="Done"
                    laneaction="NextLetterAisle">
                </AISLE>
                <ROAD
                    name="=BackToSaleItem"
                    letter="Next"
                    destination="Final"
                    tape="ADVANCE"
                    record="OFF"
                    index="ON">
                    <COMMENT>
                        This road is traversed when a Done and then Next letter is received
                    </COMMENT>
                </ROAD>
            </STATION>
            <STATION
                name="RelatedItemStation"
                servicename="modifyitem.relateditem.relateditem"
                targettier="CURRENTTIER"
                launchshuttle="RelatedItemLaunchShuttle"
                returnshuttle="RelatedItemReturnShuttle">
                <COMMENT>
                    This station goes to the related item services to add all
                    related items.
                </COMMENT>
                <AISLE
                    name="DoneSelectedAisle"
                    letter="Done"
                    laneaction="NextLetterAisle">
                </AISLE>
                <ROAD
                    name="RelatedItemsNext"
                    letter="Next"
                    destination="Final"
                    tape="ADVANCE"
                    record="OFF"
                    index="ON">
                </ROAD>                
                <ROAD
                    name="RelatedItemsCancel"
                    letter="Cancel"
                    destination="Final"
                    tape="ADVANCE"
                    record="OFF"
                    index="ON">
                </ROAD>
                <ROAD
                    name="RelatedItemsUndo"
                    letter="Undo"
                    destination="Final"
                    tape="ADVANCE"
                    record="OFF"
                    index="ON">
                </ROAD>
            </STATION>           
            <SYSTEMSITE name="Final" action="RETURN"/>
        </REGION>
    </MAP>
</SERVICE>
